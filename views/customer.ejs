<% include partials/header %>
<div class="page-fix">
  <div class="container">
    <div class="row">
      <div class="col">
        <h1 class="text-center py-3">Customer View</h1>
        <div class="border shadow rounded" id="map"></div>
      </div>
    </div>
    <div class="row">
      <div class="col-md-10 offset-md-1">
        <div class="card text-white bg-secondary my-4 text-center shadow">
          <div class="card-body">
            <p class="text-white m-0">Customer Information</p>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-md-10 offset-md-1">
        <div class="card">
          <div class="card-body">
            <% if(foundCustomer.companyName === "") { %>
              <h5 class="card-title text-center">
                <%= foundCustomer.firstName.charAt(0).toUpperCase() + foundCustomer.firstName.slice(1) %> 
                <%= foundCustomer.lastName.charAt(0).toUpperCase() + foundCustomer.lastName.slice(1) %>
              </h5>
            <% } else { %>
              <h5 class="card-title text-center">
                <%= foundCustomer.companyName.charAt(0).toUpperCase() + foundCustomer.companyName.slice(1) %>
              </h5>
            <% } %>
            <hr>
            <div class="table-responsive">
              <table class="table table-bordered">
                <thead class="text-center">
                  <tr>
                    <th scope="col">Time</th>
                    <% if(foundCustomer.companyName === "") { %>
                      <th scope="col">Name</th>
                    <% } else { %>
                      <th scope="col">Contact Name</th>
                    <% } %>
                    <th scope="col">Phone Number</th>
                    <% if(foundCustomer.email) { %>
                      <th scope="col">Email</th>
                    <% } %>
                    <th scope="col">Address</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><%= foundCustomer.time %></td>
                    <td>
                      <%= foundCustomer.firstName.charAt(0).toUpperCase() + foundCustomer.firstName.slice(1) %>
                      <%= foundCustomer.lastName.charAt(0).toUpperCase() + foundCustomer.lastName.slice(1) %>
                    </td>
                    <td><a href="tel:+1<%=foundCustomer.phoneNumber%>"><%=foundCustomer.phoneNumber%></a></td>
                    <% if(foundCustomer.email) { %>
                      <td><a href="mailto:<%=foundCustomer.email %>"><%=foundCustomer.email %></a></td>
                    <% } %>
                    <td><a href="http://maps.google.com/maps?q=<%= foundCustomer.address %>" target="_blank"><%= foundCustomer.address %></a></td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="row text-center">
              <div class="col">
                <a href="" class="btn btn-warning mb-2 btn-block">Edit Customer</a>
              </div>
              <div class="col">
                <button type="button" class="btn btn-danger mb-2 btn-block" data-toggle="modal" data-target="#deleteModal">
                  Delete Customer
                </button>
              </div>
              <div class="col">
                <button type="button" class="btn btn-primary mb-2 btn-block" data-toggle="modal" data-target="#noteModal">
                  Add Note
                </button>
              </div>
            </div>
            <div class="row text-center">
              <div class="col">
                <form action="/customers/sms/<%= foundCustomer.id %>" method="POST">
                  <button class="btn btn-success btn-block mb-2" type="submit">Send Text</button>
                </form>
              </div>
              <div class="col">
                <form action="/customers/email/<%= foundCustomer.id %>" method="POST">
                  <button class="btn btn-info btn-block mb-2" type="submit">Send Email</button>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<% include partials/noteModal %>
<% include partials/deleteModal %>
<footer class="navbar fixed-bottom navbar-dark bg-dark footer">
  <p class="text-center white footer-text">Copyright &copy;
    <span id="year"></span> by Darrell Pawson. All rights reserved.
  </p>
</footer>
<script defer>
  var foundCustomer = <%-JSON.stringify(foundCustomer) %>
</script>
<script src="/javascripts/map.js"></script>
<script src="/javascripts/jquery.min.js"></script>
<script src="/javascripts/bootstrap.bundle.min.js"></script>
<script src="/javascripts/main.js"></script>
<script defer src="https://use.fontawesome.com/releases/v5.4.2/js/all.js" integrity="sha384-wp96dIgDl5BLlOXb4VMinXPNiB32VYBSoXOoiARzSTXY+tsK8yDTYfvdTyqzdGGN" crossorigin="anonymous"></script>

</body>

</html>